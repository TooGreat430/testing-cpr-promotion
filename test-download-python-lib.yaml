steps:
  - id: upload-py-libs
    name: python
    entrypoint: bash
    args:
      - -c
      - |
        set -e
        
        root_dir="dist"
        
        pip install --upgrade twine packaging keyring keyrings.google-artifactregistry-auth

        for filename in "$root_dir"/*; do
          echo "Uploading $filename ..."
          python3 -m twine upload \
            --repository-url "https://asia-southeast2-python.pkg.dev/me-data-internal-sandbox/mlops-pipeline-python-library" \
            "$filename" \
            --verbose
        done

options:
  logging: CLOUD_LOGGING_ONLY
